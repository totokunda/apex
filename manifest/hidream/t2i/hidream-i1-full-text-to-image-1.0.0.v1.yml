api_version: apex/v1
kind: Model
metadata:
  name: Hidream-I1-Full Text to Image
  version: 1.0.0
  description: Hidream is a 17B parameter model for text-to-image generation.
  tags:
  - hidream
  - dev
  - t2i
spec:
  engine: hidream
  model_type: t2i
  engine_type: torch
  denoise_type: base
  components:
  - type: scheduler
    base: diffusers.UniPCMultistepScheduler
    config_path: HiDream-ai/HiDream-I1-Full/scheduler/scheduler_config.json
  - type: vae
    base: auto
    model_path: HiDream-ai/HiDream-I1-Full/vae
  - type: text_encoder
    name: text_encoder
    base: CLIPTextModelWithProjection
    model_path: HiDream-ai/HiDream-I1-Full/text_encoder
    tokenizer_class: CLIPTokenizer
    tokenizer_name: HiDream-ai/HiDream-I1-Full
    tokenizer_kwargs:
      subfolder: tokenizer
  - type: text_encoder
    name: text_encoder_2
    base: CLIPTextModelWithProjection
    model_path: HiDream-ai/HiDream-I1-Full/text_encoder_2
    tokenizer_class: CLIPTokenizer
    tokenizer_name: HiDream-ai/HiDream-I1-Full
    tokenizer_kwargs:
      subfolder: tokenizer_2
  - type: text_encoder
    name: text_encoder_3
    base: T5EncoderModel
    model_path: HiDream-ai/HiDream-I1-Full/text_encoder_3
    tokenizer_class: T5Tokenizer
    tokenizer_name: HiDream-ai/HiDream-I1-Full
    tokenizer_kwargs:
      subfolder: tokenizer_3
  - type: helper
    name: llama
    base: hidream.llama
    model_path: meta-llama/Meta-Llama-3.1-8B-Instruct
    tokenizer_name: meta-llama/Meta-Llama-3.1-8B-Instruct
    tokenizer_class: PreTrainedTokenizerFast
    
  - type: transformer
    base: hidream.base
    model_path: HiDream-ai/HiDream-I1-Full/transformer
  defaults:
    run:
      num_inference_steps: 40
      guidance_scale: 5.0
      return_latents: false
      text_encoder_kwargs: 
        add_special_tokens: false
        clean_text: false
        max_sequence_length: 128
      text_encoder_2_kwargs:
        add_special_tokens: false
        clean_text: false
        max_sequence_length: 128
      text_encoder_3_kwargs:
        add_special_tokens: true
        clean_text: false
        use_mask_in_input: true
        pad_with_zero: false
        max_sequence_length: 128
      attention_kwargs: {}
